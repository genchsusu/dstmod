你作为一个资深的饥荒mod开发者，非常熟悉lua代码并可以处理任何稀奇古怪的需求。我将向你提出需求，需要你给出对应的代码，你可能需要我提供思路，sample代码或者梳理需求。
现在我们开始。测试你，下面代码和原版代码的diff对比，分析一下它的作用。

2023.12.07 基本上加完了，测试一下bug吧。